
Давайте посмотрим, как в HTTP работают редиректы. Если сделать запрос на hexlet.io, то в ответ мы получим редирект:


```
telnet hexlet.io 80
GET / HTTP/1.1
host: hexlet.io

HTTP/1.1 301 Moved Permanently
Date: Thu, 14 May 2020 15:00:05 GMT
Transfer-Encoding: chunked
Connection: keep-alive
Cache-Control: max-age=3600
Expires: Thu, 14 May 2020 16:00:05 GMT
Location: https://hexlet.io/
Server: cloudflare
CF-RAY: 59357c73fadaf2a0-WAW
cf-request-id: 02b54c363b0000f2a07c8f0200000001

0
```

Это связано с тем, что hexlet.io работает только по HTTPS. Но HTTP он тоже обрабатывает. Ведь браузеру, который будет обращаться к сайту, нужно подсказать, что нужно сделать редирект.

![[Pasted image 20230212151946.png]]

Как это работает? Возвращается заголовок 300 (формат редиректов). В нашем примере мы видим _301 Moved Permanently_. Это означает, что ресурс, на который послали запрос, перемещен навсегда, и больше не имеет смысла сюда никогда заходить. Этим активно пользуются при SEO. Поисковики сохраняют все параметры страниц по старому адресу в индексе.

Редиректы бывают разных видов, например, временный редирект _302 Found_. Он используется, если что-то произошло: сайт не работает, заблокирован и т.д. В основном это технические истории.

Но как узнать, куда происходит перенаправление? И вновь никакой магии — все основано на заголовках. В принципе не важен даже _body_. В зависимости от того, как работает система, через которую послан запрос, _body_ может отобразиться, а может и нет. Главное, что появляется заголовок _Location_. Он обязан быть в случае такого статуса ответа, который указывает то место, куда нужно перейти.

Все. Дальше браузер сделал бы перенаправление автоматически. Но так как мы находимся в telnet, то никакую работу он за нас не делает и просто возвращает этот редирект.

Иногда на сайтах происходят ошибки, и те постоянно выдают редиректы. Браузер будет пытаться бесконечно переходить по ним. Чтобы не убить систему, существуют различные защиты. Например, они умеют отслеживать циклические редиректы, и сообщать, что необходимо остановить работу.

Библиотеки, с которыми часто работают программисты, обычно имеют опции. Именно опции говорят, нужно ли следовать за редиректом, и если следовать, то на какую глубину.
Шаблоны сайта содержат множество внутренних ссылок: от меню до кнопок и форм. До сих пор мы формировали эти ссылки прямо в тех местах, где они нам нужны:

``` python
<form action="/users/{{ user['id'] }}" method="post">
  <input type="submit" value="Remove">
</form>
```

Так же ссылки строятся и в обработчиках, например, при редиректах:

``` python
@app.post('/users')
def users():
    repo = UserRepository()
    user = request.form.to_dict()
    errors = validate(user)
        ... # Остальной код
    repo.save(user)
    # Тут формируется ссылка
    return redirect(f'/users/{user["id"]}', code=302)

```

В примерах выше формирование ссылки зашито прямо в то место, где она используется. Такой способ формирования ссылок потенциально опасен. Например, маршрут может измениться с `/users/{id}` на `/u/{id}`. Тогда придется пройтись по всем шаблонам и изменить все ссылки `/users/{{ user['id'] }}` на `/u/{{ user['id'] }}`.

Если этот маршрут удалить, сайт и приемочные тесты продолжат работать, но ссылки начнут вести на страницы 404. Будет лучше, если страницы с такими ссылками начнут выдавать ошибки. Тогда выявить подобные ссылки станет крайне просто.

Чтобы решить эту задачу, придумали именованные маршруты. Каждому маршруту фреймворка присваивается имя, которое затем можно использовать при построении конкретной ссылки. В Flask в качестве такого имени используется имя обработчика:

``` python
from flask import Flask, url_for

app = Flask(__name__)

@app.route('/users/')
def users():
    # Код обработчика

@app.route('/users/<id>')
def users_page(id):
    # Код обработчика

@app.route('/')
def index():
    # В функцию передается имя обработчика, а она возвращает url
    url_for('users')
    url_for('users_page', id=3)
    # Остальной код
```

В реальных приложениях ссылки формируются во многих их частях:

-   В шаблонах
-   В обработчиках (при редиректах)
-   В письмах

Поэтому большинство фреймворков предоставляют готовую функцию, которую можно использовать везде, где формируются ссылки. В шаблонах Jinja2 ссылки строятся так:

``` python
{% extends "layout.html" %}

{% block body %}
<h1>User List</h1>
<ul>
    {% for user in users %}
    <li><a href="{{ url_for('users_page', id=user.id) }}">{{ user.name }}</a></li>
    {% endfor %}
</ul>
{% endblock %}
```

Для автоматического создания URL-адреса в шаблонах Jinja2 необходимо использовать `url_for()`. В качестве первого параметра передается имя представления, а последующими параметрами — необходимые аргументы для функции-представления.

---

#### Самостоятельная работа

1.  Сделайте так, чтобы в обработчиках обращение ко всем маршрутам было через их имена